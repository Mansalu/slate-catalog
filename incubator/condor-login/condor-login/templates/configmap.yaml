apiVersion: v1
kind: ConfigMap
metadata:
  name:  {{ include "condor-login.fullname" . }}-config
  labels: 
    app: {{ template "condor-login.fullname" . }}
    chart: {{ template "condor-login.chart" . }}
    release: {{ .Release.Name }}
    instance: {{ .Values.Instance }}
data:
  tconfig-file.conf: |+
{{ .Values.LoginConfigFile | indent 4 }}
---
{{ if and .Values.AuthMethod (eq .Values.AuthMethod "token") }}
apiVersion: v1
kind: ConfigMap
metadata:
  name:  {{ include "condor-login.fullname" . }}-token-config
  labels: 
    app: {{ template "condor-login.fullname" . }}
    chart: {{ template "condor-login.chart" . }}
    release: {{ .Release.Name }}
    instance: {{ .Values.Instance }}
data:
  tconfig-file.conf: |+
  SEC_DEFAULT_AUTHENTICATION_METHODS = TOKEN,FS
  SEC_CLIENT_AUTHENTICATION_METHODS = TOKEN,FS
{{ end }}
